<script>
  var Flytxt = window.Flytxt = window.Flytxt || {};

  /**
   `Flytxt.webL10n` behavior ensures an l10n object is bound to an element and it provides a utility function `webL10n` to fetch localised strings.
   @see https://github.com/fabi1cazenave/webL10n
   @polymerBehavior Flytxt.webL10n
   */

  Flytxt.webL10n = {

    attached: function() {
      var me = this;
      if (document.webL10n) {
        me.async(function() {
          if ('complete' === document.webL10n.getReadyState()) {
            me.l10n = document.webL10n.getData();
          } else {
            document.addEventListener('localized', function() {
              me.l10n = document.webL10n.getData();
            });
          }
        });
      } else {
        console.warn('webL10n missing!');
      }
    },

    /**
     * Fetch localised string. Use this within templates to wait till this.l10n is bound.
     * 
     * @param {Object} l10n - the l10n instance bound to this element. This has to be the first argument so that calls from template bindings wait for the l10n to load.
     * @param {String} key - the key for which localised string is required.
     * @param {Array} args - to replace placeholders in localised string.
     */
    webL10n: function(l10n, key, args) {
      return document.webL10n ? document.webL10n.get(key, args) : key;
    },

    /**
     * Fetch localised string. Does not return key by default 
     * 
     * @param {String} key - the key for which localised string is required.
     * @param {Array} args - to replace placeholders in localised string.
     */
    webL10nStrict: function(key, args) {
      return document.webL10n ? document.webL10n.get(key, args) : null;
    }
  };
</script>